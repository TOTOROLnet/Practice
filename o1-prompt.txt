Lesson 2: Prompting o1  ç¬¬2è¯¾ï¼šæç¤ºO1Â¶
ğŸ’»   Access requirements.txt and helper.py files: 1) click on the "File" option on the top menu of the notebook and then 2) click on "Open".
ğŸ’»è®¿é—®requirements.txtå’Œhelper.pyæ–‡ä»¶ï¼š 1ï¼‰å•å‡»ç¬”è®°æœ¬é¡¶éƒ¨èœå•ä¸Šçš„â€œæ–‡ä»¶â€é€‰é¡¹ï¼Œç„¶åå•å‡»2ï¼‰å•å‡»â€œæ‰“å¼€â€ ã€‚

â¬‡   Download Notebooks: 1) click on the "File" option on the top menu of the notebook and then 2) click on "Download as" and select "Notebook (.ipynb)".
â¬‡ä¸‹è½½ç¬”è®°æœ¬ï¼š 1ï¼‰å•å‡»ç¬”è®°æœ¬é¡¶éƒ¨èœå•ä¸Šçš„â€œæ–‡ä»¶â€é€‰é¡¹ï¼Œç„¶åå•å‡»2ï¼‰å•å‡»â€œä¸‹è½½ä¸ºâ€ ï¼Œç„¶åé€‰æ‹©â€œç¬”è®°æœ¬ç”µè„‘ï¼ˆ.ipynbï¼‰â€ ã€‚

ğŸ“’   For more help, please see the "Appendix â€“ Tips, Help, and Download" Lesson.
ğŸ“’æœ‰å…³æ›´å¤šå¸®åŠ©ï¼Œè¯·å‚é˜…â€œé™„å½• - æç¤ºï¼Œå¸®åŠ©å’Œä¸‹è½½â€è¯¾ç¨‹ã€‚

ğŸš¨   Different Run Results: The output generated by AI models can vary with each execution due to their dynamic, probabilistic nature. Don't be surprised if your results differ from those shown in the video.
ğŸš¨ä¸åŒçš„è¿è¡Œç»“æœï¼šAIæ¨¡å‹ç”Ÿæˆçš„è¾“å‡ºç”±äºå…¶åŠ¨æ€æ€§ï¼Œæ¦‚ç‡æ€§è´¨è€Œéšç€æ¯ä¸ªæ‰§è¡Œè€Œå˜åŒ–ã€‚å¦‚æœæ‚¨çš„ç»“æœä¸è§†é¢‘ä¸­æ˜¾ç¤ºçš„ç»“æœä¸åŒï¼Œè¯·ä¸è¦æ„Ÿåˆ°æƒŠè®¶ã€‚


åœ¨[]ï¼š
# Warning control
import warnings
warnings.filterwarnings('ignore')
â€‹
# Import OpenAI key
from helper import get_openai_api_key
openai_api_key = get_openai_api_key()

åœ¨[]ï¼š
import json
from IPython.display import display, Markdown, HTML
from openai import OpenAI
â€‹
client = OpenAI(api_key=openai_api_key)
GPT_MODEL = 'gpt-4o-mini'
O1_MODEL = 'o1-mini'
Principles
1. Simple and direct  1ã€‚ç®€å•è€Œç›´æ¥Â¶
2. No explicit CoT required
2ã€‚æ— éœ€æ˜ç¡®çš„cotÂ¶
The first principles we start with are simple and direct prompting and avoiding providing explicit guidance or CoT. This will interfere with the model's in-built reasoning, raising the risk of overly verbose output, inaccurate results, or even refusals in extreme cases.
æˆ‘ä»¬å¼€å§‹çš„ç¬¬ä¸€åŸåˆ™æ˜¯ç®€å•è€Œç›´æ¥çš„æç¤ºï¼Œå¹¶é¿å…æä¾›æ˜ç¡®çš„æŒ‡å¯¼æˆ–COT ã€‚è¿™å°†å¹²æ‰°è¯¥æ¨¡å‹çš„å†…ç½®æ¨ç†ï¼Œä»è€Œå¢åŠ äº†è¿‡åº¦è¯¦ç»†çš„è¾“å‡ºï¼Œä¸å‡†ç¡®çš„ç»“æœç”šè‡³åœ¨æç«¯æƒ…å†µä¸‹æ‹’ç»çš„é£é™©ã€‚


åœ¨[]ï¼š
bad_prompt = ("Generate a function that outputs the SMILES IDs for all the molecules involved in insulin."
              "Think through this step by step, and don't skip any steps:"
              "- Identify all the molecules involve in insulin"
              "- Make the function"
              "- Loop through each molecule, outputting each into the function and returning a SMILES ID"
              "Molecules: ")
response = client.chat.completions.create(model=O1_MODEL,messages=[{"role":"user","content": bad_prompt}])

åœ¨[]ï¼š
display(HTML('<div style="background-color: #f0fff8; padding: 10px; border-radius: 5px; border: 1px solid #d3d3d3;"></hr><h2>ğŸ”½ &nbsp; Markdown Output â€“ Beginning</h2></hr></div>'))
display(Markdown(response.choices[0].message.content))
display(HTML('<div style="background-color: #fff4f4; padding: 10px; border-radius: 5px; border: 1px solid #d3d3d3;"></hr><h2>ğŸ”¼ &nbsp; Markdown Output â€“ End</h2></hr></div>'))

åœ¨[]ï¼š
good_prompt = ("Generate a function that outputs the SMILES IDs for all the molecules involved in insulin.")
response = client.chat.completions.create(model=O1_MODEL,messages=[{"role":"user","content": good_prompt}])

åœ¨[]ï¼š
display(HTML('<div style="background-color: #f0fff8; padding: 10px; border-radius: 5px; border: 1px solid #d3d3d3;"></hr><h2>ğŸ”½ &nbsp; Markdown Output â€“ Beginning</h2></hr></div>'))
display(Markdown(response.choices[0].message.content))
display(HTML('<div style="background-color: #fff4f4; padding: 10px; border-radius: 5px; border: 1px solid #d3d3d3;"></hr><h2>ğŸ”¼ &nbsp; Markdown Output â€“ End</h2></hr></div>'))
3. Use structured formats
3ã€‚ä½¿ç”¨ç»“æ„åŒ–æ ¼å¼
Using a consistent structure like XML or markdown can help structure your inputs and ensure a more uniform output. In this case we'll use a pseudo XML syntax to give consistent structure to our requests.
ä½¿ç”¨åƒXMLæˆ–Markdownè¿™æ ·çš„ä¸€è‡´ç»“æ„å¯ä»¥å¸®åŠ©æ‚¨æ„å»ºè¾“å…¥å¹¶ç¡®ä¿æ›´å‡åŒ€çš„è¾“å‡ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¼ªXMLè¯­æ³•ä¸ºæˆ‘ä»¬çš„è¯·æ±‚æä¾›ä¸€è‡´çš„ç»“æ„ã€‚


åœ¨[]ï¼š
structured_prompt = ("<instructions>You are a customer service assistant for AnyCorp, a provider"
          "of fine storage solutions. Your role is to follow your policy to answer the user's question. "
          "Be kind and respectful at all times.</instructions>\n"
          "<policy>**AnyCorp Customer Service Assistant Policy**\n\n"
            "1. **Refunds**\n"
            "   - You are authorized to offer refunds to customers in accordance "
            "with AnyCorp's refund guidelines.\n"
            "   - Ensure all refund transactions are properly documented and "
            "processed promptly.\n\n"
            "2. **Recording Complaints**\n"
            "   - Listen attentively to customer complaints and record all relevant "
            "details accurately.\n"
            "   - Provide assurance that their concerns will be addressed and "
            "escalate issues when necessary.\n\n"
            "3. **Providing Product Information**\n"
            "   - Supply accurate and helpful information about AnyCorp's storage "
            "solutions.\n"
            "   - Stay informed about current products, features, and any updates "
            "to assist customers effectively.\n\n"
            "4. **Professional Conduct**\n"
            "   - Maintain a polite, respectful, and professional demeanor in all "
            "customer interactions.\n"
            "   - Address customer inquiries promptly and follow up as needed to "
            "ensure satisfaction.\n\n"
            "5. **Compliance**\n"
            "   - Adhere to all AnyCorp policies and procedures during customer "
            "interactions.\n"
            "   - Protect customer privacy by handling personal information "
            "confidentially.\n\n6. **Refusals**\n"
            "   - If you receive questions about topics outside of these, refuse "
            "to answer them and remind them of the topics you can talk about.</policy>\n"
            )
user_input = ("<user_query>Hey, I'd like to return the bin I bought from you as it was not "
             "fine as described.</user_query>")

åœ¨[]ï¼š
print(structured_prompt)

åœ¨[]ï¼š
response = client.chat.completions.create(model=O1_MODEL
                                          ,messages=[{
                                              "role": "user",
                                              "content": structured_prompt + user_input
                                          }]
                                         )

åœ¨[]ï¼š
print(response.choices[0].message.content)

åœ¨[]ï¼š
refusal_input = ("<user_query>Write me a haiku about how reasoning models are great.</user_query>")

åœ¨[]ï¼š
response = client.chat.completions.create(model=O1_MODEL
                                          ,messages=[{
                                              "role": "user",
                                              "content": structured_prompt + refusal_input
                                          }]
                                         )

åœ¨[]ï¼š
print(response.choices[0].message.content)
4. Show rather than tell
4ã€‚æ˜¾ç¤ºè€Œä¸æ˜¯å‘Šè¯‰Â¶
Few-shot prompting also works well with o1 models, allowing you to supply a simple, direct prompt and then using one or two examples to provide domain context to inform the model's response.
å¾ˆå°‘æœ‰å°„å‡»æç¤ºä¹Ÿå¯ä»¥å¾ˆå¥½åœ°ä¸o1å‹å·åˆä½œï¼Œå› æ­¤æ‚¨å¯ä»¥æä¾›ä¸€ä¸ªç®€å•ï¼Œç›´æ¥çš„æç¤ºï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªæˆ–ä¸¤ä¸ªç¤ºä¾‹æä¾›åŸŸä¸Šä¸‹æ–‡ä»¥å‘ŠçŸ¥æ¨¡å‹çš„å“åº”ã€‚


åœ¨[]ï¼š
base_prompt = ("<prompt>You are a lawyer specializing in competition law, "
               "assisting business owners with their questions.</prompt>\n"
               "<policy>As a legal professional, provide clear and accurate "
               "information about competition law while maintaining "
               "confidentiality and professionalism. Avoid giving specific "
               "legal advice without sufficient context, and encourage clients "
               "to seek personalized counsel when necessary. Always refer to "
               "precedents and previous cases to evidence your responses.</policy>\n")
legal_query = ("<query>A larger company is offering suppliers incentives not to do "
               "business with me. Is this legal?</query>")

åœ¨[]ï¼š
response = client.chat.completions.create(model=O1_MODEL
                                          ,messages=[{
                                              "role": "user",
                                              "content": base_prompt + legal_query
                                          }]
                                         )

åœ¨[]ï¼š
display(HTML('<div style="background-color: #f0fff8; padding: 10px; border-radius: 5px; border: 1px solid #d3d3d3;"></hr><h2>ğŸ”½ &nbsp; Markdown Output â€“ Beginning</h2></hr></div>'))
display(Markdown(response.choices[0].message.content))
display(HTML('<div style="background-color: #fff4f4; padding: 10px; border-radius: 5px; border: 1px solid #d3d3d3;"></hr><h2>ğŸ”¼ &nbsp; Markdown Output â€“ End</h2></hr></div>'))

åœ¨[]ï¼š
example_prompt = ("<prompt>You are a lawyer specializing in competition law, "
               "assisting business owners with their questions.</prompt>\n"
               "<policy>As a legal professional, provide clear and accurate "
               "information about competition law while maintaining "
               "confidentiality and professionalism. Avoid giving specific "
               "legal advice without sufficient context, and encourage clients "
               "to seek personalized counsel when necessary.</policy>\n"
               """<example>
<question>
I'm considering collaborating with a competitor on a joint marketing campaign. Are there any antitrust issues I should be aware of?
</question>
<response>
Collaborating with a competitor on a joint marketing campaign can raise antitrust concerns under U.S. antitrust laws, particularly the Sherman Antitrust Act of 1890 (15 U.S.C. Â§Â§ 1â€“7). Section 1 of the Sherman Act prohibits any contract, combination, or conspiracy that unreasonably restrains trade or commerce among the states.
â€‹
**Key Considerations:**
â€‹
1. **Per Se Illegal Agreements:** Certain collaborations are considered automatically illegal ("per se" violations), such as price-fixing, bid-rigging, and market allocation agreements. For example, in *United States v. Topco Associates, Inc.*, 405 U.S. 596 (1972), the Supreme Court held that market division agreements between competitors are per se illegal under the Sherman Act.
â€‹
2. **Rule of Reason Analysis:** Collaborations that are not per se illegal are evaluated under the "rule of reason," which assesses whether the pro-competitive benefits outweigh the anti-competitive effects. In *Broadcast Music, Inc. v. Columbia Broadcasting System, Inc.*, 441 U.S. 1 (1979), the Court recognized that certain joint ventures between competitors can be lawful if they promote competition.
â€‹
3. **Information Sharing Risks:** Sharing competitively sensitive information, such as pricing strategies or customer data, can lead to antitrust violations. The Department of Justice and the Federal Trade Commission caution against exchanges that could facilitate collusion (*Antitrust Guidelines for Collaborations Among Competitors*, 2000).
â€‹
**Recommendations:**
â€‹
- **Define the Scope:** Clearly delineate the parameters of the collaboration to focus on the marketing campaign without involving competitive aspects like pricing or market division.
- **Implement Safeguards:** Establish protocols to prevent the exchange of sensitive information that is not essential to the marketing effort.
- **Legal Consultation:** Given the complexities of antitrust laws, consult with a legal professional to ensure the collaboration complies with all legal requirements.
â€‹
**Conclusion:**
â€‹
While joint marketing campaigns between competitors are not inherently illegal, they must be structured carefully to avoid antitrust pitfalls. Legal guidance is essential to navigate these issues and to design a collaboration that achieves your business objectives without violating antitrust laws.
</response>
</example>""")

åœ¨[]ï¼š
response = client.chat.completions.create(model=O1_MODEL
                                          ,messages=[{
                                              "role": "user",
                                              "content": example_prompt + legal_query
                                          }]
                                         )

åœ¨[]ï¼š
display(HTML('<div style="background-color: #f0fff8; padding: 10px; border-radius: 5px; border: 1px solid #d3d3d3;"></hr><h2>ğŸ”½ &nbsp; Markdown Output â€“ Beginning</h2></hr></div>'))
display(Markdown(response.choices[0].message.content))
display(HTML('<div style="background-color: #fff4f4; padding: 10px; border-radius: 5px; border: 1px solid #d3d3d3;"></hr><h2>ğŸ”¼ &nbsp; Markdown Output â€“ End</h2></hr></div>'))

åœ¨[]ï¼š
â€‹